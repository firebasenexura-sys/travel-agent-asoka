(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92645,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(22016),i=e.i(18566),l=e.i(33842);e.i(51718);var r=e.i(18357);e.i(36180);var o=e.i(98925);function n({message:e,type:a,onDone:i}){return(0,s.useEffect)(()=>{let e=setTimeout(i,3e3);return()=>clearTimeout(e)},[i]),(0,t.jsx)("div",{className:`fixed top-5 left-1/2 -translate-x-1/2 p-4 rounded-lg shadow-lg text-white ${"success"===a?"bg-green-600":"bg-red-600"} z-50`,children:e})}function d({text:e="Memuat..."}){return(0,t.jsx)("div",{className:"fixed inset-0 bg-white/80 z-[60] flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-blue-600 rounded-full animate-spin"}),(0,t.jsx)("p",{className:"mt-2 text-gray-700 font-semibold",children:e})]})})}function m(){let e=(0,i.useRouter)(),[m,c]=(0,s.useState)(null),[u,x]=(0,s.useState)(!0),[g,b]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null),[p,y]=(0,s.useState)([]),[j,N]=(0,s.useState)(!1),[v,w]=(0,s.useState)(null),[T,k]=(0,s.useState)(""),[S,C]=(0,s.useState)(""),q=(0,o.collection)(l.db,"testimonials");(0,s.useEffect)(()=>{let t=(0,r.onAuthStateChanged)(l.auth,t=>{t?c(t.uid):e.push("/admin")}),s=()=>{};if(m){0!==p.length||j||x(!0);let e=(0,o.query)(q,(0,o.orderBy)("createdAt","desc"));s=(0,o.onSnapshot)(e,e=>{y(e.docs.map(e=>({id:e.id,...e.data()}))),x(!1)},e=>{console.error("Gagal mengambil data testimoni:",e),f({msg:"Gagal memuat data testimoni.",type:"error"}),x(!1)})}else x(!1);return()=>{t(),s()}},[e,m,j]);let D=()=>{w(null),k(""),C("")},A=()=>{g||(D(),N(!1))},B=async e=>{if(e.preventDefault(),!m||!T||!S)return void f({msg:"Nama pelanggan dan isi testimoni wajib diisi.",type:"error"});b(!0),f(null);try{let e={customerName:T,quote:S,updatedAt:(0,o.serverTimestamp)()};if(v){let t=(0,o.doc)(l.db,"testimonials",v);await (0,o.updateDoc)(t,e),console.log("Testimoni diupdate:",v)}else{let t=await (0,o.addDoc)(q,{...e,createdAt:(0,o.serverTimestamp)()});console.log("Testimoni baru ditambahkan:",t.id)}f({msg:"Testimoni berhasil disimpan!",type:"success"}),A()}catch(e){console.error("Gagal menyimpan testimoni:",e),f({msg:`Gagal menyimpan: ${e.message||e.code}`,type:"error"})}finally{b(!1)}},G=async e=>{if(confirm(`Yakin ingin menghapus testimoni dari "${e.customerName}"?`)){b(!0),f(null);try{await (0,o.deleteDoc)((0,o.doc)(l.db,"testimonials",e.id)),console.log("Dokumen testimoni dihapus:",e.id),f({msg:"Testimoni berhasil dihapus.",type:"success"})}catch(e){console.error("Gagal menghapus testimoni:",e),f({msg:`Gagal menghapus: ${e.message||e.code}`,type:"error"})}finally{b(!1)}}};return(0,t.jsxs)(t.Fragment,{children:[h&&(0,t.jsx)(n,{message:h.msg,type:h.type,onDone:()=>f(null)}),u&&(0,t.jsx)(d,{text:"Memuat testimoni..."}),g&&(0,t.jsx)(d,{text:"Menyimpan/Menghapus..."}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(a.default,{href:"/dashboard/cms",children:(0,t.jsxs)("span",{className:"text-gray-500 hover:text-blue-600 cursor-pointer",children:[(0,t.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Kembali ke Hpanel"]})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Kelola Testimoni"})]}),(0,t.jsxs)("button",{onClick:()=>{D(),N(!0)},className:"bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-blue-700 transition-all flex items-center gap-2",children:[(0,t.jsx)("i",{className:"fas fa-plus"})," Tambah Testimoni"]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[(0,t.jsxs)("h3",{className:"text-xl font-semibold text-gray-800 border-b border-gray-200 pb-3 mb-4",children:[(0,t.jsx)("i",{className:"fas fa-comments mr-2 text-teal-500"})," Daftar Testimoni"]}),u?(0,t.jsx)("p",{className:"text-center py-6 text-gray-500",children:"Memuat..."}):p.length>0?(0,t.jsx)("ul",{className:"space-y-4",children:p.map(e=>(0,t.jsxs)("li",{className:"flex items-start gap-4 p-4 border border-gray-100 rounded-lg bg-gray-50 group hover:bg-white hover:shadow-md transition-all",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 text-teal-600 flex items-center justify-center mt-1",children:(0,t.jsx)("i",{className:"fas fa-quote-left"})}),(0,t.jsxs)("div",{className:"flex-grow",children:[(0,t.jsxs)("blockquote",{className:"text-gray-700 italic",children:['"',e.quote,'"']}),(0,t.jsxs)("p",{className:"text-sm font-semibold text-gray-900 mt-2",children:["- ",e.customerName]})]}),(0,t.jsxs)("div",{className:"flex-shrink-0 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity focus-within:opacity-100",children:[(0,t.jsx)("button",{onClick:()=>{D(),w(e.id),k(e.customerName),C(e.quote),N(!0)},className:"text-blue-600 hover:text-blue-800 text-sm font-medium p-1 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Edit",children:(0,t.jsx)("i",{className:"fas fa-edit"})}),(0,t.jsx)("button",{onClick:()=>G(e),className:"text-red-600 hover:text-red-800 text-sm font-medium p-1 rounded focus:outline-none focus:ring-2 focus:ring-red-500",title:"Hapus",children:(0,t.jsx)("i",{className:"fas fa-trash"})})]})]},e.id))}):(0,t.jsx)("p",{className:"text-center text-gray-500 py-10",children:'Belum ada testimoni. Klik "Tambah Testimoni" untuk memulai.'})]}),j&&(0,t.jsxs)("div",{className:"fixed inset-0 bg-black/50 z-40 flex items-center justify-center p-4",children:[(0,t.jsx)("div",{onClick:A,className:"absolute inset-0"}),(0,t.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 sticky top-0 bg-white rounded-t-2xl z-10",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:v?"Edit Testimoni":"Tambah Testimoni Baru"}),(0,t.jsx)("button",{onClick:A,className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)("i",{className:"fas fa-times fa-lg"})})]}),(0,t.jsxs)("form",{id:"testimonialForm",onSubmit:B,className:"flex-grow overflow-y-auto p-6 space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama Pelanggan"}),(0,t.jsx)("input",{id:"customerName",type:"text",value:T,onChange:e=>k(e.target.value),required:!0,className:"w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"quote",className:"block text-sm font-medium text-gray-700 mb-1",children:"Isi Testimoni / Kutipan"}),(0,t.jsx)("textarea",{id:"quote",value:S,onChange:e=>C(e.target.value),rows:6,required:!0,className:"w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Tuliskan testimoni pelanggan di sini..."})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end p-5 border-t border-gray-200 sticky bottom-0 bg-gray-50 rounded-b-2xl z-10",children:[(0,t.jsx)("button",{onClick:A,type:"button",className:"bg-white text-gray-700 font-semibold py-2 px-4 rounded-lg border border-gray-300 mr-3 hover:bg-gray-50",children:"Batal"}),(0,t.jsxs)("button",{type:"submit",form:"testimonialForm",disabled:g,className:"bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[g?(0,t.jsx)("i",{className:"fas fa-spinner fa-spin"}):(0,t.jsx)("i",{className:"fas fa-save"}),v?"Update Testimoni":"Simpan Testimoni"]})]})]})]})]})}e.s(["default",()=>m])}]);